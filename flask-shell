#!/bin/bash
# Simple Flask + Pipenv Shell Launcher

echo "ðŸš€ Starting Flask Development Environment..."
echo "ðŸ“¦ Installing dependencies if needed..."

# Install dependencies if needed
if [ ! -f "Pipfile.lock" ]; then
    pipenv install
fi

echo "ðŸ”¥ Starting Flask server on http://127.0.0.1:5555"
echo "ðŸ’¡ When you exit the shell, Flask will automatically stop"
echo ""

# Start Flask in background
python server/app.py &
FLASK_PID=$!
echo "âœ… Flask started with PID: $FLASK_PID"

# Function to cleanup Flask when shell exits
cleanup() {
    echo ""
    echo "ðŸ›‘ Stopping Flask server (PID: $FLASK_PID)..."
    kill $FLASK_PID 2>/dev/null
    wait $FLASK_PID 2>/dev/null
    echo "ðŸ‘‹ Development environment stopped!"
}

# Set trap to cleanup on shell exit
trap cleanup EXIT

# Activate pipenv shell
exec pipenv shell
